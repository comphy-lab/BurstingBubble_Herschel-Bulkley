<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="base-url" content="..">
    <title>postProcess/getData.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles</title>
<a id="" href="#"></a>
    <!-- Critical CSS for fastest paint -->
    <style>
        .s-intro__title {
            visibility: visible;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        .s-header {
            visibility: visible;
        }
    </style>
<a id="" href="#"></a>
    <!-- Preload critical resources -->
    <link rel="preload" href="../assets/js/main.js" as="script">
    <link rel="preload" href="../assets/css/fontello/css/fontello.css" as="style">
    <link rel="preload" href="../assets/css/academicons-1.7.0/css/academicons.min.css" as="style">
<a id="" href="#"></a>
    <!-- Base stylesheet with proper path resolution for local deployment -->
    <link rel="stylesheet" href="../assets/css/styles.css">
    <link rel="stylesheet" href="../assets/css/custom_styles.css">
    <link rel="stylesheet" href="../assets/css/fontello/css/fontello.css">
    <link rel="stylesheet" href="../assets/css/academicons-1.7.0/css/academicons.min.css">
    <link rel="stylesheet" href="../assets/css/command-palette.css">
    <!-- Font Awesome for icons on all documentation pages -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
<a id="" href="#"></a>
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="../assets/favicon/apple-touch-icon.png">
    <link rel="apple-touch-icon-precomposed" sizes="180x180" href="../assets/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="96x96" href="../assets/favicon/favicon-96x96.png">
    <link rel="icon" type="image/svg+xml" href="../assets/favicon/favicon.svg">
    <link rel="manifest" href="../assets/favicon/site.webmanifest">
    <link rel="shortcut icon" href="../assets/favicon/favicon.ico">
    <link rel="icon" href="../assets/favicon/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-title" content="CoMPhy Lab">
<a id="" href="#"></a>
    <!-- SEO Meta Tags -->
    <meta name="description" content="Computational fluid dynamics simulations using Basilisk C framework.">
    <meta name="author" content="CoMPhy Lab">
    <meta name="robots" content="index, follow">
    <meta name="keywords" content="fluid dynamics, CFD, Basilisk, multiphase flow, computational physics">
<a id="" href="#"></a>
    <!-- Font dependencies with font-display: swap -->
    <style>
        @font-face {
            font-display: swap;
            font-family: 'System Font';
            src: local('system-ui');
        }
    </style>
    <link rel="stylesheet" href="../assets/css/fontello/css/fontello.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" href="../assets/css/academicons-1.7.0/css/academicons.min.css" media="print" onload="this.media='all'">
    <noscript>
        <link rel="stylesheet" href="../assets/css/fontello/css/fontello.css">
        <link rel="stylesheet" href="../assets/css/academicons-1.7.0/css/academicons.min.css">
    </noscript>
<a id="" href="#"></a>
    <!-- Site styles -->
    <link rel="stylesheet" href="../assets/css/vendor.css">
    <link rel="stylesheet" href="../assets/css/styles.css">
    <link rel="stylesheet" href="../assets/css/custom_styles.css">
    <link rel="stylesheet" href="../assets/css/command-palette.css" media="print" onload="this.media='all'">
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>   
    <!-- Fuse.js for search functionality -->
    <script defer src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js"></script>
<a id="" href="#"></a>
    <!-- jQuery and UI -->
    <script src="../assets/js/jquery.min.js"></script>
    <script src="../assets/js/jquery-ui.packed.js"></script>
    <script src="../assets/js/plots.js"></script>
<a id="" href="#"></a>
    <!-- Command palette -->
    <script defer src="../assets/js/command-palette.js"></script>
    <script defer src="../assets/js/command-data.js"></script>
    <script defer src="../assets/js/main.js"></script>
    <script defer src="../assets/js/theme-toggle.js"></script>
<a id="" href="#"></a>
    <script>
        // Load Font Awesome with proper environment detection and fallbacks
        function loadStylesheet(href) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = href;
          link.crossOrigin = 'anonymous';
          link.onerror = (e) => {
            console.error(`Failed to load stylesheet: `);
            console.log('Trying alternative Font Awesome source...');
          };
          document.head.appendChild(link);
          return link;
        }
<a id="" href="#"></a>
        // Check if we're on localhost
        if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
          // Use hardcoded version numbers for reliable loading
<a id="" href="#"></a>
          // Load Font Awesome using multiple CDNs to maximize reliability for local development
          loadStylesheet('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css');
          // Backup CDN if the first one fails
          loadStylesheet('https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css');
          // Final local fallback - ensures it will work on any localhost environment
          loadStylesheet('https://use.fontawesome.com/releases/v6.7.2/css/all.css');
        } else {
          // Use Kit for production with defer
          var script = document.createElement('script');
          script.src = 'https://kit.fontawesome.com/b1cfd9ca75.js';
          script.crossOrigin = 'anonymous';
          script.defer = true;
          document.head.appendChild(script);
        }
      </script>
<a id="" href="#"></a>
    <script>
        document.documentElement.classList.remove('no-js');
        document.documentElement.classList.add('js');
    </script>
<a id="" href="#"></a>
        true
    </head>
<body id="top">
<script>window.repoName = "BurstingBubble_Herschel-Bulkley";</script>

<a id="" href="#"></a>
    <div id="preloader">
        <div id="loader"></div>
    </div>
<a id="" href="#"></a>
    <div id="page" class="s-pagewrap">
        <header class="s-header">
            <div class="s-header__logo">
                <a class="logo" href="/">
                    <img src="../assets/logos/CoMPhy-Lab-no-name.png" alt="CoMPhy Lab">
                </a>
                <a class="documentation-button" href="/BurstingBubble_Herschel-Bulkley">
                    <i class="fa-solid fa-book-open"></i>
                    <span>BurstingBubble_Herschel-Bulkley</span>
                </a>
            </div>
            <a class="s-header__menu-toggle" href="#0">
                <span class="s-header__menu-text">Menu</span>
                <span class="s-header__menu-icon"></span>
            </a>
            <nav class="s-header__nav">
                <a href="#0" class="s-header__nav-close-btn"><span>Close</span></a>
                <ul class="s-header__nav-list">
                    <li style="background: none;">
                        <div class="theme-toggle" id="theme-toggle" aria-label="Toggle dark/light theme">
                            <svg class="theme-toggle-icon moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                            </svg>
                            <svg class="theme-toggle-icon sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="5"></circle>
                                <line x1="12" y1="1" x2="12" y2="3"></line>
                                <line x1="12" y1="21" x2="12" y2="23"></line>
                                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                                <line x1="1" y1="12" x2="3" y2="12"></line>
                                <line x1="21" y1="12" x2="23" y2="12"></line>
                                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                            </svg>
                        </div>
                    </li>
                    <li style="background: none;"><a href="https://scholar.google.com/citations?user=tHb_qZoAAAAJ&hl=en" style="background: none; padding: 0;" aria-label="Google Scholar Profile"><i class="ai ai-google-scholar" style="font-size: 1.75em;"></i></a></li>
                    <li style="background: none;"><a href="https://github.com/comphy-lab" style="background: none; padding: 0;" aria-label="GitHub Organization"><i class="fa-brands fa-github" style="font-size: 1.75em"></i></a></li>
                    <li><a href="https://comphy-lab.org/#about" class="smoothscroll">About</a></li>
                    <li><a href="https://comphy-lab.org/team/">Team</a></li>
                    <li><a href="https://comphy-lab.org/research">Research</a></li>
                    <li><a href="https://comphy-lab.org/teaching">Teaching</a></li>
                    <li><a href="https://comphy-lab.org/join">Join Us</a></li>
                    <li><a href="https://blogs.comphy-lab.org/">Blog</a></li>
                    <li style="background: none;"><a href="https://bsky.app/profile/comphy-lab.org" style="background: none; padding: 0;" aria-label="Bluesky Profile"><i class="fa-brands fa-bluesky" style="font-size: 1.75em; color: #0085ff;"></i></a></li>
                    <!-- Command Palette Button (Styled like search) -->
                    <li class="command-palette-button">
                        <div class="command-wrapper">
                            <button class="command-k-style-btn" id="command-palette-btn" aria-label="Open command palette">
                                <span class="default-theme-text">ctrl K</span>
                                <span class="mac-theme-text">⌘ K</span>
                                <i class="fa-solid fa-magnifying-glass search-icon"></i>
                            </button>
                        </div>
                    </li>
                </ul>
            </nav>
        </header>
<a id="" href="#"></a>
        <!-- Main content -->
        <main class="content">
<a id="" href="#"></a>
            <div class="page-content">
<a id="" href="#"></a>
                                <h1 class="page-title">postProcess/getData.c</h1>
<a id="" href="#"></a>
<a id="" href="#"></a>
                <h1 id="fluid-simulation-data-extraction">Fluid
                Simulation Data Extraction</h1>
                <p>This program extracts and processes data from fluid
                dynamics simulation snapshots. It calculates key fluid
                mechanics quantities like strain rate tensor invariants
                and velocity magnitudes from simulation output
                files.</p>
                <h2 id="physical-background">Physical Background</h2>
                <p>The code analyzes the spatial derivatives of velocity
                fields to compute the second invariant of the strain
                rate tensor, which is an important quantity for
                identifying vortical structures in fluid flows.
                Additionally, it calculates velocity magnitudes
                throughout the flow field.</p>
                <p>The strain rate tensor is a fundamental quantity in
                fluid mechanics that describes the rate of deformation
                of fluid elements. Its second invariant is particularly
                useful for identifying regions of strong vorticity and
                shear, making it valuable for visualizing coherent
                structures in turbulent flows.</p>
                <h2 id="usage">Usage</h2>
                <div class="code-block-container"><pre><code>./program filename xmin ymin xmax ymax ny</code></pre></div>
                <ul>
                <li>filename: Path to simulation snapshot file</li>
                <li>xmin, ymin: Minimum coordinates of the region of
                interest</li>
                <li>xmax, ymax: Maximum coordinates of the region of
                interest</li>
                <li>ny: Number of grid points in y-direction
                (resolution)</li>
                </ul>
                <p><span class="citation"
                data-cites="author">@author</span> Vatsal Sanjay <span
                class="citation"
                data-cites="affiliation">@affiliation</span> Physics of
                Fluids Group, University of Twente <span
                class="citation" data-cites="email">@email</span>
                vatsalsanjay@gmail.com</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb2-1"><span class="pp">#include </span><a href="http://basilisk.fr/src/utils.h" title="Link to Basilisk source for utils.h"><span class="im">"utils.h"</span></a></span>
<span id="cb2-2"><span class="pp">#include </span><a href="http://basilisk.fr/src/output.h" title="Link to Basilisk source for output.h"><span class="im">"output.h"</span></a></span>
<span id="cb2-3"></span>
<span id="cb2-4">scalar f<span class="op">[];</span>  <span class="co">// Volume fraction field</span></span>
<span id="cb2-5">vector u<span class="op">[];</span>  <span class="co">// Velocity field</span></span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="dt">char</span> filename<span class="op">[</span><span class="dv">80</span><span class="op">];</span></span>
<span id="cb2-8"><span class="dt">int</span> nx<span class="op">,</span> ny<span class="op">,</span> len<span class="op">;</span></span>
<span id="cb2-9"><span class="dt">double</span> xmin<span class="op">,</span> ymin<span class="op">,</span> xmax<span class="op">,</span> ymax<span class="op">,</span> Deltax<span class="op">,</span> Deltay<span class="op">;</span></span>
<span id="cb2-10"></span>
<span id="cb2-11">scalar D2c<span class="op">[],</span> vel<span class="op">[];</span>  <span class="co">// Derived fields</span></span>
<span id="cb2-12">scalar <span class="op">*</span> list <span class="op">=</span> NULL<span class="op">;</span>  <span class="co">// List of fields to output</span></span></code></pre></div></div>
                <h3 id="main-function">Main Function</h3>
                <p>Processes command line arguments, restores simulation
                data, computes derived quantities, and outputs results
                to a formatted file.</p>
                <ul>
                <li>a: Number of command line arguments</li>
                <li>arguments: Array of command line argument
                strings</li>
                </ul>
                <p>Returns exit status code</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb3-1"><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">char</span> <span class="dt">const</span> <span class="op">*</span>arguments<span class="op">[])</span></span>
<span id="cb3-2"><span class="op">{</span></span>
<span id="cb3-3">  <span class="co">// Parse command line arguments</span></span>
<span id="cb3-4">  sprintf<span class="op">(</span>filename<span class="op">,</span> <span class="st">&quot;</span><span class="sc">%s</span><span class="st">&quot;</span><span class="op">,</span> arguments<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb3-5">  xmin <span class="op">=</span> atof<span class="op">(</span>arguments<span class="op">[</span><span class="dv">2</span><span class="op">]);</span> ymin <span class="op">=</span> atof<span class="op">(</span>arguments<span class="op">[</span><span class="dv">3</span><span class="op">]);</span></span>
<span id="cb3-6">  xmax <span class="op">=</span> atof<span class="op">(</span>arguments<span class="op">[</span><span class="dv">4</span><span class="op">]);</span> ymax <span class="op">=</span> atof<span class="op">(</span>arguments<span class="op">[</span><span class="dv">5</span><span class="op">]);</span></span>
<span id="cb3-7">  ny <span class="op">=</span> atoi<span class="op">(</span>arguments<span class="op">[</span><span class="dv">6</span><span class="op">]);</span></span>
<span id="cb3-8"></span>
<span id="cb3-9">  <span class="co">// Initialize list of fields to output</span></span>
<span id="cb3-10">  list <span class="op">=</span> list_add<span class="op">(</span>list<span class="op">,</span> D2c<span class="op">);</span></span>
<span id="cb3-11">  list <span class="op">=</span> list_add<span class="op">(</span>list<span class="op">,</span> vel<span class="op">);</span></span></code></pre></div></div>
                <h2 id="data-processing">Data Processing</h2>
                <p>Restores simulation data and calculates derived
                quantities at each point:</p>
                <ul>
                <li>D2c: Log10 of the second invariant of the strain
                rate tensor</li>
                <li>vel: Velocity magnitude field</li>
                </ul>
                <p>The strain rate tensor components are computed using
                finite difference approximations of the velocity
                gradients.</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb4-1">  restore<span class="op">(</span>file <span class="op">=</span> filename<span class="op">);</span></span>
<span id="cb4-2">  foreach<span class="op">()</span> <span class="op">{</span></span>
<span id="cb4-3">    <span class="co">// Calculate components of the strain rate tensor</span></span>
<span id="cb4-4">    <span class="dt">double</span> D11 <span class="op">=</span> <span class="op">(</span>u<span class="op">.</span>y<span class="op">[</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">]</span> <span class="op">-</span> u<span class="op">.</span>y<span class="op">[</span><span class="dv">0</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">])/(</span><span class="dv">2</span> <span class="op">*</span> Delta<span class="op">);</span></span>
<span id="cb4-5">    <span class="dt">double</span> D22 <span class="op">=</span> <span class="op">(</span>u<span class="op">.</span>y<span class="op">[]/</span>y<span class="op">);</span></span>
<span id="cb4-6">    <span class="dt">double</span> D33 <span class="op">=</span> <span class="op">(</span>u<span class="op">.</span>x<span class="op">[</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">]</span> <span class="op">-</span> u<span class="op">.</span>x<span class="op">[-</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">])/(</span><span class="dv">2</span> <span class="op">*</span> Delta<span class="op">);</span></span>
<span id="cb4-7">    <span class="dt">double</span> D13 <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="op">((</span>u<span class="op">.</span>y<span class="op">[</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">]</span> <span class="op">-</span> u<span class="op">.</span>y<span class="op">[-</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">]</span> <span class="op">+</span> u<span class="op">.</span>x<span class="op">[</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">]</span> <span class="op">-</span> u<span class="op">.</span>x<span class="op">[</span><span class="dv">0</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">])/(</span><span class="dv">2</span> <span class="op">*</span> Delta<span class="op">));</span></span>
<span id="cb4-8"></span>
<span id="cb4-9">    <span class="co">// Calculate the second invariant</span></span>
<span id="cb4-10">    <span class="dt">double</span> D2 <span class="op">=</span> <span class="op">(</span>sq<span class="op">(</span>D11<span class="op">)</span> <span class="op">+</span> sq<span class="op">(</span>D22<span class="op">)</span> <span class="op">+</span> sq<span class="op">(</span>D33<span class="op">)</span> <span class="op">+</span> <span class="fl">2.0</span> <span class="op">*</span> sq<span class="op">(</span>D13<span class="op">));</span></span>
<span id="cb4-11">    D2c<span class="op">[]</span> <span class="op">=</span> f<span class="op">[]</span> <span class="op">*</span> sqrt<span class="op">(</span>D2<span class="op">/</span><span class="fl">2.0</span><span class="op">);</span></span>
<span id="cb4-12"></span>
<span id="cb4-13">    <span class="co">// Convert to log scale for better visualization</span></span>
<span id="cb4-14">    <span class="cf">if</span> <span class="op">(</span>D2c<span class="op">[]</span> <span class="op">&gt;</span> <span class="fl">0.</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-15">      D2c<span class="op">[]</span> <span class="op">=</span> log<span class="op">(</span>D2c<span class="op">[])/</span>log<span class="op">(</span><span class="dv">10</span><span class="op">);</span></span>
<span id="cb4-16">    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb4-17">      D2c<span class="op">[]</span> <span class="op">=</span> <span class="op">-</span><span class="dv">10</span><span class="op">;</span>  <span class="co">// Floor value for zero or negative values</span></span>
<span id="cb4-18">    <span class="op">}</span></span>
<span id="cb4-19"></span>
<span id="cb4-20">    <span class="co">// Calculate velocity magnitude</span></span>
<span id="cb4-21">    vel<span class="op">[]</span> <span class="op">=</span> f<span class="op">[]</span> <span class="op">*</span> sqrt<span class="op">(</span>sq<span class="op">(</span>u<span class="op">.</span>x<span class="op">[])</span> <span class="op">+</span> sq<span class="op">(</span>u<span class="op">.</span>y<span class="op">[]));</span></span>
<span id="cb4-22">  <span class="op">}</span></span></code></pre></div></div>
                <h2 id="data-output">Data Output</h2>
                <p>This section handles the output of processed
                data:</p>
                <ol type="1">
                <li>Calculates the mesh dimensions based on
                user-specified bounds</li>
                <li>Interpolates field values onto a regular grid</li>
                <li>Writes output data to a formatted text file</li>
                </ol>
                <p>The output format is a space-separated values file
                with columns: x-coordinate, y-coordinate, followed by
                values of each field in ‘list’.</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb5-1">  <span class="dt">FILE</span> <span class="op">*</span> fp <span class="op">=</span> ferr<span class="op">;</span></span>
<span id="cb5-2"></span>
<span id="cb5-3">  <span class="co">// Calculate grid spacing and dimensions</span></span>
<span id="cb5-4">  Deltay <span class="op">=</span> <span class="op">(</span><span class="dt">double</span><span class="op">)((</span>ymax <span class="op">-</span> ymin<span class="op">)/(</span>ny<span class="op">));</span></span>
<span id="cb5-5">  nx <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">)((</span>xmax <span class="op">-</span> xmin<span class="op">)/</span>Deltay<span class="op">);</span></span>
<span id="cb5-6">  Deltax <span class="op">=</span> <span class="op">(</span><span class="dt">double</span><span class="op">)((</span>xmax <span class="op">-</span> xmin<span class="op">)/(</span>nx<span class="op">));</span></span>
<span id="cb5-7">  len <span class="op">=</span> list_len<span class="op">(</span>list<span class="op">);</span></span>
<span id="cb5-8"></span>
<span id="cb5-9">  <span class="co">// Allocate memory for interpolated field values</span></span>
<span id="cb5-10">  <span class="dt">double</span> <span class="op">**</span> field <span class="op">=</span> <span class="op">(</span><span class="dt">double</span> <span class="op">**)</span> matrix_new<span class="op">(</span>nx<span class="op">,</span> ny <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> len <span class="op">*</span> <span class="kw">sizeof</span><span class="op">(</span><span class="dt">double</span><span class="op">));</span></span>
<span id="cb5-11"></span>
<span id="cb5-12">  <span class="co">// Interpolate field values onto regular grid</span></span>
<span id="cb5-13">  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> nx<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb5-14">    <span class="dt">double</span> x <span class="op">=</span> Deltax <span class="op">*</span> <span class="op">(</span>i <span class="op">+</span> <span class="fl">1.</span><span class="op">/</span><span class="dv">2</span><span class="op">)</span> <span class="op">+</span> xmin<span class="op">;</span></span>
<span id="cb5-15">    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> ny<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb5-16">      <span class="dt">double</span> y <span class="op">=</span> Deltay <span class="op">*</span> <span class="op">(</span>j <span class="op">+</span> <span class="fl">1.</span><span class="op">/</span><span class="dv">2</span><span class="op">)</span> <span class="op">+</span> ymin<span class="op">;</span></span>
<span id="cb5-17">      <span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-18">      <span class="cf">for</span> <span class="op">(</span>scalar s in list<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-19">        field<span class="op">[</span>i<span class="op">][</span>len <span class="op">*</span> j <span class="op">+</span> k<span class="op">++]</span> <span class="op">=</span> interpolate<span class="op">(</span>s<span class="op">,</span> x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb5-20">      <span class="op">}</span></span>
<span id="cb5-21">    <span class="op">}</span></span>
<span id="cb5-22">  <span class="op">}</span></span>
<span id="cb5-23"></span>
<span id="cb5-24">  <span class="co">// Write interpolated data to output file</span></span>
<span id="cb5-25">  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> nx<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb5-26">    <span class="dt">double</span> x <span class="op">=</span> Deltax <span class="op">*</span> <span class="op">(</span>i <span class="op">+</span> <span class="fl">1.</span><span class="op">/</span><span class="dv">2</span><span class="op">)</span> <span class="op">+</span> xmin<span class="op">;</span></span>
<span id="cb5-27">    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> ny<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb5-28">      <span class="dt">double</span> y <span class="op">=</span> Deltay <span class="op">*</span> <span class="op">(</span>j <span class="op">+</span> <span class="fl">1.</span><span class="op">/</span><span class="dv">2</span><span class="op">)</span> <span class="op">+</span> ymin<span class="op">;</span></span>
<span id="cb5-29">      fprintf<span class="op">(</span>fp<span class="op">,</span> <span class="st">&quot;</span><span class="sc">%g</span><span class="st"> </span><span class="sc">%g</span><span class="st">&quot;</span><span class="op">,</span> x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb5-30">      <span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-31">      <span class="cf">for</span> <span class="op">(</span>scalar s in list<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-32">        fprintf<span class="op">(</span>fp<span class="op">,</span> <span class="st">&quot; </span><span class="sc">%g</span><span class="st">&quot;</span><span class="op">,</span> field<span class="op">[</span>i<span class="op">][</span>len <span class="op">*</span> j <span class="op">+</span> k<span class="op">++]);</span></span>
<span id="cb5-33">      <span class="op">}</span></span>
<span id="cb5-34">      fputc<span class="op">(</span><span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span><span class="op">,</span> fp<span class="op">);</span></span>
<span id="cb5-35">    <span class="op">}</span></span>
<span id="cb5-36">  <span class="op">}</span></span>
<span id="cb5-37"></span>
<span id="cb5-38">  <span class="co">// Clean up resources</span></span>
<span id="cb5-39">  fflush<span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb5-40">  fclose<span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb5-41">  matrix_free<span class="op">(</span>field<span class="op">);</span></span>
<span id="cb5-42"><span class="op">}</span></span></code></pre></div></div>
            </div>
        </main>
<a id="" href="#"></a>
        <footer class="site-footer">
            <div class="footer-left">
              <a href="http://basilisk.fr/sandbox/vatsal/" target="_blank">
                <img src="../assets/logos/logoBasilisk_TransparentBackground.png" alt="Basilisk C" class="footer-logo">
              </a>
              <a href="https://pof.tnw.utwente.nl/" target="_blank">
                <img src="../assets/logos/LogoPof_transparent_white.png" alt="Physics of Fluids" class="footer-logo pof-logo">
              </a>
              <a href="https://www.utwente.nl/" target="_blank">
                <img src="../assets/logos/UT_Logo_2400_Sta_White_EN.png" alt="University of Twente" class="footer-logo">
              </a>
              <a href="https://www.vatsalsanjay.com/" target="_blank">
                <img src="../assets/logos/Logo_Vatsal_v3_OutLine.png" alt="Vatsal Sanjay" class="footer-logo">
              </a>
            </div>
            <div class="footer-center">
              <p class="copyright-text">
                &copy; Copyright<br>
                CoMPhy Lab 2025
              </p>
            </div>
            <div class="footer-right">
              <a href="https://scholar.google.com/citations?user=tHb_qZoAAAAJ&hl=en" target="_blank" aria-label="Google Scholar Profile">
                <i class="ai ai-google-scholar" style="font-size: 2.5em; color: white;"></i>
              </a>
              <a href="https://github.com/comphy-lab" target="_blank" aria-label="GitHub Organization">
                <i class="fa-brands fa-github" style="font-size: 2.5em; color: white;"></i>
              </a>
              <a href="https://www.youtube.com/@CoMPhyLab" target="_blank" aria-label="YouTube Channel">
                <i class="fa-brands fa-youtube" style="font-size: 2.5em; color: white;"></i>
              </a>
              <a href="https://x.com/VatsalSanjay" target="_blank" aria-label="X (Twitter) Profile">
                <i class="fa-brands fa-x-twitter" style="font-size: 2.5em; color: white;"></i>
              </a>
              <a href="https://bsky.app/profile/comphy-lab.org" target="_blank" aria-label="Bluesky Profile">
                <i class="fa-brands fa-bluesky" style="font-size: 2.5em; color: white;"></i>
              </a>
              <a href="https://github.com/comphy-lab/comphy-lab.github.io" class="edit-link" aria-label="Edit this page on GitHub">
                <i class="fa-brands fa-github"></i> Edit this page
              </a>
            </div>
          </footer>
    </div>  
<a id="" href="#"></a>
    <!-- Command Palette -->
    <div id="simple-command-palette" class="simple-command-palette" style="display: none;">
        <div class="simple-command-palette-backdrop"></div>
        <div class="simple-command-palette-modal">
            <input type="text" id="command-palette-input" placeholder="Type a command..." autocomplete="off">
            <div id="command-palette-results" class="command-palette-results"></div>
            <div class="command-palette-footer">
                <span class="command-palette-footer-item"><kbd>↑</kbd> <kbd>↓</kbd> to navigate</span>
                <span class="command-palette-footer-item"><kbd>enter</kbd> to select</span>
                <span class="command-palette-footer-item"><kbd>esc</kbd> to close</span>
            </div>
        </div>
    </div>
<a id="" href="#"></a>

    <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function() {
        // Add copy button to each code block container
        const codeBlocks = document.querySelectorAll('.code-block-container pre');
        codeBlocks.forEach(function(codeBlock, index) {
            // Create button element
            const button = document.createElement('button');
            button.className = 'copy-button';
            button.textContent = 'Copy';
            button.setAttribute('aria-label', 'Copy code to clipboard');
            button.setAttribute('data-copy-state', 'copy');
            
            // Get the code block container (parent of the pre)
            const container = codeBlock.parentNode;
            
            // Add the button to the container
            container.appendChild(button);
            
            // Set up click event
            button.addEventListener('click', function() {
                // Create a textarea element to copy from
                const textarea = document.createElement('textarea');
                // Get the text content from the pre element (the actual code)
                textarea.value = codeBlock.textContent;
                document.body.appendChild(textarea);
                textarea.select();
                
                try {
                    // Execute copy command
                    document.execCommand('copy');
                    // Update button state
                    button.textContent = 'Copied!';
                    button.classList.add('copied');
                    
                    // Reset button state after 2 seconds
                    setTimeout(function() {
                        button.textContent = 'Copy';
                        button.classList.remove('copied');
                    }, 2000);
                } catch (err) {
                    console.error('Copy failed:', err);
                    button.textContent = 'Error!';
                }
                
                // Clean up
                document.body.removeChild(textarea);
            });
        });
    });
    </script>
        </body>
</html>
